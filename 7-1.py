inpt = ["af AND ah -> ai",
"NOT lk -> ll",
"hz RSHIFT 1 -> is",
"NOT go -> gp",
"du OR dt -> dv",
"x RSHIFT 5 -> aa",
"at OR az -> ba",
"eo LSHIFT 15 -> es",
"ci OR ct -> cu",
"b RSHIFT 5 -> f",
"fm OR fn -> fo",
"NOT ag -> ah",
"v OR w -> x",
"g AND i -> j",
"an LSHIFT 15 -> ar",
"op AND cx -> cy",
"jq AND jw -> jy",
"iu RSHIFT 5 -> ix",
"gl AND gm -> go",
"NOT bw -> bx",
"jp RSHIFT 3 -> jr",
"hg AND hh -> hj",
"bv AND bx -> by",
"er OR es -> et",
"kl OR kr -> ks",
"et RSHIFT 1 -> fm",
"e AND f -> h",
"u LSHIFT 1 -> ao",
"he RSHIFT 1 -> hx",
"eg AND ei -> ej",
"bo AND bu -> bw",
"dz OR ef -> eg",
"dy RSHIFT 3 -> ea",
"gl OR gm -> gn",
"da LSHIFT 1 -> du",
"au OR av -> aw",
"gj OR gu -> gv",
"eu OR fa -> fb",
"lg OR lm -> ln",
"e OR f -> g",
"NOT dm -> dn",
"NOT l -> m",
"aq OR ar -> as",
"gj RSHIFT 5 -> gm",
"hm AND ho -> hp",
"ge LSHIFT 15 -> gi",
"jp RSHIFT 1 -> ki",
"hg OR hh -> hi",
"lc LSHIFT 1 -> lw",
"km OR kn -> ko",
"eq LSHIFT 1 -> fk",
"op AND am -> an",
"gj RSHIFT 1 -> hc",
"aj AND al -> am",
"gj AND gu -> gw",
"ko AND kq -> kr",
"ha OR gz -> hb",
"bn OR by -> bz",
"iv OR jb -> jc",
"NOT ac -> ad",
"bo OR bu -> bv",
"d AND j -> l",
"bk LSHIFT 1 -> ce",
"de OR dk -> dl",
"dd RSHIFT 1 -> dw",
"hz AND ik -> im",
"NOT jd -> je",
"fo RSHIFT 2 -> fp",
"hb LSHIFT 1 -> hv",
"lf RSHIFT 2 -> lg",
"gj RSHIFT 3 -> gl",
"ki OR kj -> kk",
"NOT ak -> al",
"ld OR le -> lf",
"ci RSHIFT 3 -> ck",
"op AND cc -> cd",
"NOT kx -> ky",
"fp OR fv -> fw",
"ev AND ew -> ey",
"dt LSHIFT 15 -> dx",
"NOT ax -> ay",
"bp AND bq -> bs",
"NOT ii -> ij",
"ci AND ct -> cv",
"iq OR ip -> ir",
"x RSHIFT 2 -> y",
"fq OR fr -> fs",
"bn RSHIFT 5 -> bq",
"0 -> c",
"956 -> b",
"d OR j -> k",
"z OR aa -> ab",
"gf OR ge -> gg",
"df OR dg -> dh",
"NOT hj -> hk",
"NOT di -> dj",
"fj LSHIFT 15 -> fn",
"lf RSHIFT 1 -> ly",
"b AND n -> p",
"jq OR jw -> jx",
"gn AND gp -> gq",
"x RSHIFT 1 -> aq",
"ex AND ez -> fa",
"NOT fc -> fd",
"bj OR bi -> bk",
"as RSHIFT 5 -> av",
"hu LSHIFT 15 -> hy",
"NOT gs -> gt",
"fs AND fu -> fv",
"dh AND dj -> dk",
"bz AND cb -> cc",
"dy RSHIFT 1 -> er",
"hc OR hd -> he",
"fo OR fz -> ga",
"t OR s -> u",
"b RSHIFT 2 -> d",
"NOT jy -> jz",
"hz RSHIFT 2 -> ia",
"kk AND kv -> kx",
"ga AND gc -> gd",
"fl LSHIFT 1 -> gf",
"bn AND by -> ca",
"NOT hr -> hs",
"NOT bs -> bt",
"lf RSHIFT 3 -> lh",
"au AND av -> ax",
"op AND gd -> ge",
"jr OR js -> jt",
"fw AND fy -> fz",
"NOT iz -> ja",
"c LSHIFT 1 -> t",
"dy RSHIFT 5 -> eb",
"bp OR bq -> br",
"NOT h -> i",
"op AND ds -> dt",
"ab AND ad -> ae",
"ap LSHIFT 1 -> bj",
"br AND bt -> bu",
"NOT ca -> cb",
"NOT el -> em",
"s LSHIFT 15 -> w",
"gk OR gq -> gr",
"ff AND fh -> fi",
"kf LSHIFT 15 -> kj",
"fp AND fv -> fx",
"lh OR li -> lj",
"bn RSHIFT 3 -> bp",
"jp OR ka -> kb",
"lw OR lv -> lx",
"iy AND ja -> jb",
"dy OR ej -> ek",
"op AND bh -> bi",
"NOT kt -> ku",
"ao OR an -> ap",
"ia AND ig -> ii",
"NOT ey -> ez",
"bn RSHIFT 1 -> cg",
"fk OR fj -> fl",
"ce OR cd -> cf",
"eu AND fa -> fc",
"kg OR kf -> kh",
"jr AND js -> ju",
"iu RSHIFT 3 -> iw",
"df AND dg -> di",
"dl AND dn -> do",
"la LSHIFT 15 -> le",
"fo RSHIFT 1 -> gh",
"NOT gw -> gx",
"NOT gb -> gc",
"ir LSHIFT 1 -> jl",
"x AND ai -> ak",
"he RSHIFT 5 -> hh",
"op AND lu -> lv",
"NOT ft -> fu",
"gh OR gi -> gj",
"lf RSHIFT 5 -> li",
"x RSHIFT 3 -> z",
"b RSHIFT 3 -> e",
"he RSHIFT 2 -> hf",
"NOT fx -> fy",
"jt AND jv -> jw",
"hx OR hy -> hz",
"jp AND ka -> kc",
"fb AND fd -> fe",
"hz OR ik -> il",
"ci RSHIFT 1 -> db",
"fo AND fz -> gb",
"fq AND fr -> ft",
"gj RSHIFT 2 -> gk",
"cg OR ch -> ci",
"cd LSHIFT 15 -> ch",
"jm LSHIFT 1 -> kg",
"ih AND ij -> ik",
"fo RSHIFT 3 -> fq",
"fo RSHIFT 5 -> fr",
"op AND fi -> fj",
"op AND kz -> la",
"iu AND jf -> jh",
"cq AND cs -> ct",
"dv LSHIFT 1 -> ep",
"hf OR hl -> hm",
"km AND kn -> kp",
"de AND dk -> dm",
"dd RSHIFT 5 -> dg",
"NOT lo -> lp",
"NOT ju -> jv",
"NOT fg -> fh",
"cm AND co -> cp",
"ea AND eb -> ed",
"dd RSHIFT 3 -> df",
"gr AND gt -> gu",
"ep OR eo -> eq",
"cj AND cp -> cr",
"lf OR lq -> lr",
"gg LSHIFT 1 -> ha",
"et RSHIFT 2 -> eu",
"NOT jh -> ji",
"ek AND em -> en",
"jk LSHIFT 15 -> jo",
"ia OR ig -> ih",
"gv AND gx -> gy",
"et AND fe -> fg",
"lh AND li -> lk",
"op AND io -> ip",
"kb AND kd -> ke",
"kk RSHIFT 5 -> kn",
"id AND if -> ig",
"NOT ls -> lt",
"dw OR dx -> dy",
"dd AND do -> dq",
"lf AND lq -> ls",
"NOT kc -> kd",
"dy AND ej -> el",
"op AND ke -> kf",
"et OR fe -> ff",
"hz RSHIFT 5 -> ic",
"dd OR do -> dp",
"cj OR cp -> cq",
"NOT dq -> dr",
"kk RSHIFT 1 -> ld",
"jg AND ji -> jj",
"he OR hp -> hq",
"hi AND hk -> hl",
"dp AND dr -> ds",
"dz AND ef -> eh",
"hz RSHIFT 3 -> ib",
"db OR dc -> dd",
"hw LSHIFT 1 -> iq",
"he AND hp -> hr",
"NOT cr -> cs",
"lg AND lm -> lo",
"hv OR hu -> hw",
"il AND in -> io",
"NOT eh -> ei",
"gz LSHIFT 15 -> hd",
"gk AND gq -> gs",
"op AND en -> eo",
"NOT kp -> kq",
"et RSHIFT 5 -> ew",
"lj AND ll -> lm",
"he RSHIFT 3 -> hg",
"et RSHIFT 3 -> ev",
"as AND bd -> bf",
"cu AND cw -> cx",
"jx AND jz -> ka",
"b OR n -> o",
"be AND bg -> bh",
"op AND ht -> hu",
"op AND gy -> gz",
"NOT hn -> ho",
"ck OR cl -> cm",
"ec AND ee -> ef",
"lv LSHIFT 15 -> lz",
"ks AND ku -> kv",
"NOT ie -> if",
"hf AND hl -> hn",
"op AND r -> s",
"ib AND ic -> ie",
"hq AND hs -> ht",
"y AND ae -> ag",
"NOT ed -> ee",
"bi LSHIFT 15 -> bm",
"dy RSHIFT 2 -> dz",
"ci RSHIFT 2 -> cj",
"NOT bf -> bg",
"NOT im -> in",
"ev OR ew -> ex",
"ib OR ic -> id",
"bn RSHIFT 2 -> bo",
"dd RSHIFT 2 -> de",
"bl OR bm -> bn",
"as RSHIFT 1 -> bl",
"ea OR eb -> ec",
"ln AND lp -> lq",
"kk RSHIFT 3 -> km",
"is OR it -> iu",
"iu RSHIFT 2 -> iv",
"as OR bd -> be",
"ip LSHIFT 15 -> it",
"iw OR ix -> iy",
"kk RSHIFT 2 -> kl",
"NOT bb -> bc",
"ci RSHIFT 5 -> cl",
"ly OR lz -> ma",
"z AND aa -> ac",
"iu RSHIFT 1 -> jn",
"cy LSHIFT 15 -> dc",
"cf LSHIFT 1 -> cz",
"as RSHIFT 3 -> au",
"cz OR cy -> da",
"kw AND ky -> kz",
"lx -> a",
"iw AND ix -> iz",
"lr AND lt -> lu",
"jp RSHIFT 5 -> js",
"aw AND ay -> az",
"jc AND je -> jf",
"lb OR la -> lc",
"NOT cn -> co",
"kh LSHIFT 1 -> lb",
"op AND jj -> jk",
"y OR ae -> af",
"ck AND cl -> cn",
"kk OR kv -> kw",
"NOT cv -> cw",
"kl AND kr -> kt",
"iu OR jf -> jg",
"at AND az -> bb",
"jp RSHIFT 2 -> jq",
"iv AND jb -> jd",
"jn OR jo -> jp",
"x OR ai -> aj",
"ba AND bc -> bd",
"jl OR jk -> jm",
"b RSHIFT 1 -> v",
"o AND q -> r",
"NOT p -> q",
"k AND m -> n",
"as RSHIFT 2 -> at"]

allVars = ["af", "ah", "ai","lk", "ll","hz", "is","go", "gp","du", "dt", "dv","x", "aa","at", "az", "ba","eo", "es","ci", "ct", "cu",
"b", "f","fm", "fn", "fo","ag", "ah","v", "w", "x","g", "i", "j","an", "ar", "cx", "cy","jq", "jw", "jy","iu", "ix","gl", "gm", "go","bw",
 "bx","jp", "jr","hg", "hh", "hj","bv", "bx", "by","er", "es", "et","kl", "kr", "ks","et", "fm","e", "f", "h","u", "ao","he", "hx","eg", 
 "ei", "ej","bo", "bu", "bw","dz", "ef", "eg","dy", "ea","gl", "gm", "gn","da", "du","au", "av", "aw","gj", "gu", "gv","eu", "fa", "fb",
 "lg", "lm", "ln","e", "f", "g","dm", "dn","l", "m","aq", "ar", "as","gj", "gm","hm", "ho", "hp","ge", "gi","jp", "ki","hg", "hh", "hi",
 "lc", "lw","km", "kn", "ko","eq", "fk", "am", "an","gj", "hc","aj", "al", "am","gj", "gu", "gw","ko", "kq", "kr","ha", "gz", "hb","bn", 
 "by", "bz","iv", "jb", "jc","ac", "ad","bo", "bu", "bv","d", "j", "l","bk", "ce","de", "dk", "dl","dd", "dw","hz", "ik", "im","jd", "je",
 "fo", "fp","hb", "hv","lf", "lg","gj", "gl","ki", "kj", "kk","ak", "al","ld", "le", "lf","ci", "ck", "cc", "cd","kx", "ky","fp", "fv", 
 "fw","ev", "ew", "ey","dt", "dx","ax", "ay","bp", "bq", "bs","ii", "ij","ci", "ct", "cv","iq", "ip", "ir","x", "y","fq", "fr", "fs","bn", 
 "bq", "c","b","d", "j", "k","z", "aa", "ab","gf", "ge", "gg","df", "dg", "dh","hj", "hk","di", "dj","fj", "fn","lf", "ly","b", "n", 
 "p","jq", "jw", "jx","gn", "gp", "gq","x", "aq","ex", "ez", "fa","fc", "fd","bj", "bi", "bk","as", "av","hu", "hy","gs", "gt","fs", "fu", 
 "fv","dh", "dj", "dk","bz", "cb", "cc","dy", "er","hc", "hd", "he","fo", "fz", "ga","t", "s", "u","b", "d","jy", "jz","hz", "ia","kk", 
 "kv", "kx","ga", "gc", "gd","fl", "gf","bn", "by", "ca","hr", "hs","bs", "bt","lf", "lh","au", "av", "ax","gd", "ge","jr", "js", "jt",
 "fw", "fy", "fz","iz", "ja","c", "t","dy",  "eb","bp", "bq", "br","h", "i","ds", "dt","ab", "ad", "ae","ap", "bj","br", "bt", "bu","ca", 
 "cb","el", "em","s", "w","gk", "gq", "gr","ff", "fh", "fi","kf", "kj","fp", "fv", "fx","lh", "li", "lj","bn",  "bp","jp", "ka", "kb","lw", 
 "lv", "lx","iy", "ja", "jb","dy", "ej", "ek","bh", "bi","kt", "ku","ao", "an", "ap","ia", "ig", "ii","ey", "ez","bn", "cg","fk", "fj", 
 "fl","ce", "cd", "cf","eu", "fa", "fc","kg", "kf", "kh","jr", "js", "ju","iu",  "iw","df", "dg", "di","dl", "dn", "do","la", "le","fo", 
 "gh","gw", "gx","gb", "gc","ir",  "jl","x", "ai", "ak","he",  "hh","lu", "lv","ft", "fu","gh", "gi", "gj","lf",  "li","x",  "z","b", 
 "e","he", "hf","fx", "fy","jt", "jv", "jw","hx", "hy", "hz","jp", "ka", "kc","fb", "fd", "fe","hz", "ik", "il","ci",  "db","fo", "fz", 
 "gb","fq", "fr", "ft","gj", "gk","cg", "ch", "ci","cd", "ch","jm",  "kg","ih", "ij", "ik","fo",  "fq","fo",  "fr","fi", "fj","kz", "la",
 "iu", "jf", "jh","cq", "cs", "ct","dv",  "ep","hf", "hl", "hm","km", "kn", "kp","de", "dk", "dm","dd", "dg","lo", "lp","ju", "jv","fg", 
 "fh","cm", "co", "cp","ea", "eb", "ed","dd", "df","gr", "gt", "gu","ep", "eo", "eq","cj", "cp", "cr","lf", "lq", "lr","gg", "ha","et", 
 "eu","jh", "ji","ek", "em", "en","jk", "jo","ia", "ig", "ih","gv", "gx", "gy","et", "fe", "fg","lh", "li", "lk","io", "ip","kb", "kd", 
 "ke","kk",  "kn","id", "if", "ig","ls", "lt","dw", "dx", "dy","dd", "do", "dq","lf", "lq", "ls","kc", "kd","dy", "ej", "el","ke", "kf",
 "et", "fe", "ff","hz",  "ic","dd", "do", "dp","cj", "cp", "cq","dq", "dr","kk",  "ld","jg", "ji", "jj","he", "hp", "hq","hi", "hk", "hl",
 "dp", "dr", "ds","dz", "ef", "eh","hz",  "ib","db", "dc", "dd","hw",  "iq","he", "hp", "hr","cr", "cs","lg", "lm", "lo","hv", "hu", "hw",
 "il", "in", "io","eh", "ei","gz", "hd","gk", "gq", "gs","en", "eo","kp", "kq","et",  "ew","lj", "ll", "lm","he",  "hg","et",  "ev","as", 
 "bd", "bf","cu", "cw", "cx","jx", "jz", "ka","b", "n", "o","be", "bg", "bh","ht", "hu","gy", "gz","hn", "ho","ck", "cl", "cm","ec", "ee", 
 "ef","lv", "lz","ks", "ku", "kv","ie", "if","hf", "hl", "hn","r", "s","ib", "ic", "ie","hq", "hs", "ht","y", "ae", "ag","ed", "ee","bi",
  "bm","dy", "dz","ci", "cj","bf", "bg","im", "in","ev", "ew", "ex","ib", "ic", "id","bn", "bo","dd", "de","bl", "bm", "bn","as", "bl","ea", 
  "eb", "ec","ln", "lp", "lq","kk", "km","is", "it", "iu","iu", "iv","as", "bd", "be","ip", "it","iw", "ix", "iy","kk", "kl","bb", "bc","ci", 
  "cl","ly", "lz", "ma","z", "aa", "ac","iu", "jn","cy", "dc","cf", "cz","as", "au","cz", "cy", "da","kw", "ky", "kz","lx", "a","iw", "ix", 
  "iz","lr", "lt", "lu","jp", "js","aw", "ay", "az","jc", "je", "jf","lb", "la", "lc","cn", "co","kh", "lb","jj", "jk","y", "ae", "af","ck", 
  "cl", "cn","kk", "kv", "kw","cv", "cw","kl", "kr", "kt","iu", "jf", "jg","at", "az", "bb","jp", "jq","iv", "jb", "jd","jn", "jo", "jp",
  "x", "ai", "aj","ba", "bc", "bd","jl", "jk", "jm","b", "v","o", "q", "r","p", "q","k", "m", "n","as", "at"]

currLine = ""
variables = []
variables.sort()
print(variables)
wtiteTo = ""
varA = ""
varB = ""
varAVal = 0
varBVal = 0
bits = 0
allSolved = False
solvedCtr = 0
number = 0
x = 0

for i in allVars:
    if i not in variables:
        variables.append(i)
        variables.append(0)
        variables.append(False)

variables.append("op")
variables.append(1)
variables.append(True)
print(variables)
print(len(inpt))

while (allSolved == False):
    x = 0
    while(x<len(inpt)):
        currLine = inpt[x]
        writeTo = currLine[(currLine.find(">")+2):]

        if "OR" in currLine:
            varA = currLine[:currLine.find(" ")]
            varAVal = variables[variables.index(varA)+1]
            varB = currLine[currLine.find("R")+2:currLine.find("-")-1]
            varBVal = variables[variables.index(varB)+1]

            if variables[variables.index(varA)+2] == True and variables[variables.index(varB)+2] == True:
                print(currLine)
                print(varA)
                print(varAVal)
                print(varB)
                print(varBVal)
                variables[variables.index(writeTo)+1] = ( varAVal | varBVal ) & 65535
                variables[variables.index(writeTo)+2] = True 
                print("Result =", variables[variables.index(writeTo)+1])
                print("In:", writeTo)
                print("---------")
                solvedCtr += 1
                inpt.remove(inpt[x])
    
        elif "AND" in currLine:
            varA = currLine[:currLine.find(" ")]
            varAVal = variables[variables.index(varA)+1]
            varB = currLine[currLine.find("D")+2:currLine.find("-")-1]
            varBVal = variables[variables.index(varB)+1]

            if variables[variables.index(varA)+2] == True and variables[variables.index(varB)+2] == True:
                print(currLine)
                print(varA)
                print(varAVal)
                print(varB)
                print(varBVal)
                variables[variables.index(writeTo)+1] = ( varAVal & varBVal ) & 65535
                variables[variables.index(writeTo)+2] = True 
                print("Result =", variables[variables.index(writeTo)+1])
                print("In:", writeTo)
                print("---------")
                solvedCtr += 1
                inpt.remove(inpt[x])

        elif "RSHIFT" in currLine:
            varA = currLine[:currLine.find("R")-1]
            varAVal = variables[variables.index(varA)+1]
            bits = int(currLine[currLine.find("T")+2:currLine.find("-")-1])
            if variables[variables.index(varA)+2] == True:
                print(currLine)
                print(varA, "=", varAVal)
                print("bitshift", bits, "Bits")
                variables[variables.index(writeTo)+1] = ( varAVal >> bits ) & 65535
                variables[variables.index(writeTo)+2] = True 
                print("Result =", variables[variables.index(writeTo)+1])
                print("In:", writeTo)
                print("---------")
                solvedCtr += 1
                inpt.remove(inpt[x])

        elif "LSHIFT" in currLine:
            varA = currLine[:currLine.find("L")-1]
            varAVal = variables[variables.index(varA)+1]
            bits = int(currLine[currLine.find("T")+2:currLine.find("-")-1])

            if variables[variables.index(varA)+2] == True:
                print(currLine)
                print(varA, "=", varAVal)
                print("bitshift", bits, "Bits")
                variables[variables.index(writeTo)+1] = ( varAVal << bits ) & 65535
                variables[variables.index(writeTo)+2] = True 
                print("Result =", variables[variables.index(writeTo)+1])
                print("In:", writeTo)
                print("---------")
                solvedCtr += 1
                inpt.remove(inpt[x])

        elif "NOT" in currLine:
            varA = currLine[currLine.find("T")+2:currLine.find("-")-1]
            varAVal = variables[variables.index(varA)+1]

            if variables[variables.index(varA)+2] == True:
                print(currLine)
                print(varA)
                print(varAVal)
                variables[variables.index(writeTo)+1] = (~ varAVal ) & 65535
                variables[variables.index(writeTo)+2] = True 
                print("Result =", variables[variables.index(writeTo)+1])
                print("---------")
                solvedCtr += 1
                inpt.remove(inpt[x])
        else:
            varA = currLine[:currLine.find("-")-1]
            if (currLine[:currLine.find("-")-1]).isdigit():
                number = int(currLine[:currLine.find("-")-1])
                variables[variables.index(writeTo)+1] = number
                variables[variables.index(writeTo)+2] = True
                inpt.remove(inpt[x])
                solvedCtr += 1
                print(currLine)
                print(number, "Written to: ", writeTo)
                print("Should True", variables[variables.index(writeTo)+2])
                print("---------")
            elif variables[variables.index(varA)+2] == True and variables[variables.index(varA)+2] == True:
                varA = currLine[:currLine.find("-")-1]
                number = variables[variables.index(varA)+1]
                variables[variables.index(writeTo)+1] = number
                variables[variables.index(writeTo)+2] = True
                inpt.remove(inpt[x])
                solvedCtr += 1
                print(currLine)
                print(number, "Written to: ", writeTo)
                print("Should True", variables[variables.index(writeTo)+2])
                print("---------")
        x += 1
    if solvedCtr >= 339:
        break
print(variables[variables.index("a")+1])
    #print(variables[variables.index("a")+1])
    
        #print(x)
        #if variables[variables.index("lx")+2] == False:
        #    print("T or F", variables[variables.index("lx")+2])

        #    "14146 -> b"



#print(variables[variables.index("a")+1])
